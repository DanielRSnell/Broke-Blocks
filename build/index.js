(()=>{"use strict";var e,t={575:(e,t,n)=>{const l=window.wp.blocks,o=window.wp.i18n,i=window.wp.blockEditor,r=window.wp.element,s=window.wp.components,a=window.wp.compose,c=window.ReactJSXRuntime;function d({globalAttrs:e,setAttributes:t}){const{src:n="",alt:l="",width:r="",height:a=""}=e,d=()=>{const n={...e};delete n.src,delete n.alt,delete n.width,delete n.height,t({globalAttrs:n})};return(0,c.jsxs)(s.PanelBody,{title:(0,o.__)("Image Settings","universal-block"),initialOpen:!0,children:[(0,c.jsx)(i.MediaUploadCheck,{children:(0,c.jsx)(i.MediaUpload,{onSelect:n=>{const l={...e,src:n.url};n.alt&&(l.alt=n.alt),n.width&&(l.width=n.width.toString()),n.height&&(l.height=n.height.toString()),t({globalAttrs:l})},allowedTypes:["image"],value:n,render:({open:e})=>(0,c.jsx)("div",{children:n?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{marginBottom:"12px"},children:(0,c.jsx)("img",{src:n,alt:l||"",style:{maxWidth:"100%",height:"auto",border:"1px solid #ddd",borderRadius:"4px"}})}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,c.jsx)(s.Button,{onClick:e,variant:"secondary",children:(0,o.__)("Replace Image","universal-block")}),(0,c.jsx)(s.Button,{onClick:d,variant:"tertiary",isDestructive:!0,children:(0,o.__)("Remove","universal-block")})]})]}):(0,c.jsx)(s.Button,{onClick:e,variant:"primary",children:(0,o.__)("Select Image","universal-block")})})})}),n&&(0,c.jsxs)("div",{style:{marginTop:"16px"},children:[(0,c.jsx)(s.TextControl,{label:(0,o.__)("Alt Text","universal-block"),value:l,onChange:n=>((n,l)=>{t({globalAttrs:{...e,[n]:l}})})("alt",n),help:(0,o.__)("Describe the image for accessibility","universal-block")}),(0,c.jsxs)("div",{style:{marginTop:"8px",fontSize:"12px",color:"#757575"},children:[r&&a&&(0,c.jsxs)("div",{style:{marginBottom:"4px"},children:[(0,c.jsx)("strong",{children:(0,o.__)("Dimensions:","universal-block")})," ",r," × ",a]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{children:(0,o.__)("Source:","universal-block")}),(0,c.jsx)("div",{style:{wordBreak:"break-all",marginTop:"2px"},children:n})]})]})]})]})}const p=window.wp.data;function u({globalAttrs:e,setAttributes:t}){const{href:n="",target:l="",rel:i="","aria-label":a=""}=e,[d,u]=(0,r.useState)(!n||n.startsWith("http")||n.startsWith("//")),[b,h]=(0,r.useState)("page"),[g,x]=(0,r.useState)(""),[v,k]=(0,r.useState)(!1),m=(n,l)=>{t({globalAttrs:{...e,[n]:l}})},f=n=>{const l={...e};delete l[n],t({globalAttrs:l})},{posts:_,postTypes:y}=(0,p.useSelect)(e=>{if(!v||d)return{posts:null,postTypes:null};const{getEntityRecords:t,getPostTypes:n}=e("core");return{posts:t("postType",b,{per_page:100,orderby:"title",order:"asc",status:"publish"}),postTypes:n({per_page:-1})}},[b,v,d]),w=y?y.filter(e=>e.viewable&&"attachment"!==e.slug).map(e=>({label:e.labels.singular_name,value:e.slug})):[],j=_?[{label:(0,o.__)("Select a post...","universal-block"),value:""},..._.map(e=>({label:e.title.rendered||(0,o.__)("(no title)","universal-block"),value:e.id}))]:[{label:(0,o.__)("Loading...","universal-block"),value:""}];return(0,c.jsxs)(s.PanelBody,{title:(0,o.__)("Link Settings","universal-block"),initialOpen:!1,onToggle:e=>k(e),children:[(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("External Link","universal-block"),checked:d,onChange:e=>{u(e),e||(f("href"),x(""))},help:d?(0,o.__)("Enter a URL manually","universal-block"):(0,o.__)("Select from posts/pages","universal-block")}),d?(0,c.jsx)(s.TextControl,{label:(0,o.__)("URL","universal-block"),value:n,onChange:e=>m("href",e),placeholder:"https://example.com",help:(0,o.__)("Enter the full URL including https://","universal-block")}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.SelectControl,{label:(0,o.__)("Post Type","universal-block"),value:b,options:w,onChange:h}),(0,c.jsx)(s.SelectControl,{label:(0,o.__)("Select Post/Page","universal-block"),value:g,options:j,onChange:e=>{if(x(e),e&&_){const t=_.find(t=>t.id===parseInt(e));t&&m("href",t.link)}}}),n&&(0,c.jsxs)("div",{style:{marginTop:"8px",padding:"8px",background:"#f0f0f0",borderRadius:"4px",fontSize:"12px",wordBreak:"break-all"},children:[(0,c.jsx)("strong",{children:(0,o.__)("URL:","universal-block")})," ",n]})]}),(0,c.jsxs)("div",{style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid #ddd"},children:[(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("Open in New Tab","universal-block"),checked:"_blank"===l,onChange:e=>{e?(m("target","_blank"),m("rel","noopener noreferrer")):(f("target"),f("rel"))},help:"_blank"===l?(0,o.__)("Link opens in new tab/window","universal-block"):(0,o.__)("Link opens in same tab","universal-block")}),"_blank"===l&&(0,c.jsx)(s.TextControl,{label:(0,o.__)("Rel Attribute","universal-block"),value:i,onChange:e=>m("rel",e),help:(0,o.__)("Relationship attributes (e.g., noopener noreferrer)","universal-block")}),(0,c.jsx)(s.TextControl,{label:(0,o.__)("ARIA Label","universal-block"),value:a,onChange:e=>m("aria-label",e),placeholder:(0,o.__)("Descriptive label for screen readers","universal-block"),help:(0,o.__)("Optional: Improve accessibility with a descriptive label","universal-block")})]}),n&&(0,c.jsx)(s.Button,{onClick:()=>{f("href"),f("target"),f("rel"),f("aria-label"),x("")},variant:"tertiary",isDestructive:!0,style:{marginTop:"16px"},children:(0,o.__)("Remove Link","universal-block")})]})}function b(){return window.ubBlockSettings?.settings||{inspectorControls:{plainClassesManager:{enabled:!0},dynamicPreviewToggle:{enabled:!0},elementSettings:{enabled:!0},imageSettings:{enabled:!0},linkSettings:{enabled:!0},loopControls:{enabled:!0},conditionalVisibility:{enabled:!0},setVariable:{enabled:!0}},blockControls:{tagNameToolbar:{enabled:!0},dynamicPreviewButton:{enabled:!0}}}}function h(e){const t=b();return t.inspectorControls?.[e]?!1!==t.inspectorControls[e].enabled:!t.blockControls?.[e]||!1!==t.blockControls[e].enabled}function g(e,t){const n=b(),l=n.inspectorControls?.[e];return!l||!1!==l.enabled&&(!l.controls?.[t]||!1!==l.controls[t].enabled)}function x({tagName:e,onChange:t}){const[n,l]=(0,r.useState)(!1),[i,a]=(0,r.useState)(e),d=()=>{i&&i.trim()&&t(i.trim()),l(!1)},p=window.ubBlockSettings?.allowedTags||[],u=p.length>0,b=e.charAt(0).toUpperCase()+e.slice(1);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.ToolbarButton,{onClick:()=>{a(e),l(!0)},"aria-label":(0,o.__)("Change tag name","universal-block"),style:{fontFamily:"Monaco, Menlo, monospace",fontSize:"11px",fontWeight:"900",letterSpacing:"0.5px"},children:b}),n&&(0,c.jsx)(s.Popover,{position:"bottom center",onClose:()=>l(!1),focusOnMount:"firstElement",children:(0,c.jsx)("div",{style:{padding:"16px",minWidth:"250px"},children:u?(0,c.jsx)(s.SelectControl,{label:(0,o.__)("HTML Tag","universal-block"),value:i,options:p.map(e=>({label:e.charAt(0).toUpperCase()+e.slice(1),value:e})),onChange:e=>{a(e),t(e),l(!1)},help:(0,o.__)("Select element type","universal-block")}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.TextControl,{label:(0,o.__)("HTML Tag Name","universal-block"),value:i,onChange:a,onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),d()):"Escape"===e.key&&l(!1)},placeholder:"div, section, article...",help:(0,o.__)("Press Enter to save, Esc to cancel","universal-block"),style:{fontFamily:"Monaco, Menlo, monospace"},autoFocus:!0}),(0,c.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px",justifyContent:"flex-end"},children:[(0,c.jsx)(s.Button,{variant:"secondary",onClick:()=>l(!1),size:"small",children:(0,o.__)("Cancel","universal-block")}),(0,c.jsx)(s.Button,{variant:"primary",onClick:d,size:"small",children:(0,o.__)("Save","universal-block")})]})]})})})]})}function v({className:e="",onChange:t}){const[n,l]=(0,r.useState)(""),i=(0,r.useRef)(null),s=e?e.split(" ").filter(e=>e.trim()):[],a=()=>{if(!n.trim())return;const e=n.trim().split(/\s+/).filter(e=>e),o=[...s,...e],r=[...new Set(o)];t(r.join(" ")),l(""),setTimeout(()=>i.current?.focus(),0)},d=e=>{const n=s.filter(t=>t!==e);t(n.join(" "))};return(0,c.jsxs)("div",{style:{background:"#fff"},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px"},children:[(0,c.jsx)("label",{style:{fontSize:"11px",fontWeight:"600",color:"#1e1e1e",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Classes"}),s.length>0&&(0,c.jsx)("span",{style:{fontSize:"11px",color:"#666",background:"#f0f0f0",padding:"2px 8px",borderRadius:"10px"},children:s.length})]}),(0,c.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",minHeight:"40px",padding:"10px",background:"#f9f9f9",borderRadius:"4px",border:"1px solid #ddd",cursor:"text"},onClick:()=>i.current?.focus(),children:[s.map((e,t)=>(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",background:"#2271b1",color:"#fff",padding:"6px 10px",borderRadius:"4px",fontSize:"12px",fontFamily:"Monaco, Menlo, monospace",lineHeight:"1.2",height:"fit-content"},children:[(0,c.jsx)("span",{children:e}),(0,c.jsx)("button",{onClick:t=>{t.stopPropagation(),d(e)},style:{background:"transparent",border:"none",color:"#fff",cursor:"pointer",padding:"0",display:"flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",borderRadius:"50%",opacity:.8},onMouseEnter:e=>e.currentTarget.style.opacity="1",onMouseLeave:e=>e.currentTarget.style.opacity="0.8","aria-label":(0,o.__)("Remove class","universal-block"),children:(0,c.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:(0,c.jsx)("path",{d:"M1 1L9 9M9 1L1 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]},t)),(0,c.jsx)("input",{ref:i,type:"text",value:n,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),a()):"Backspace"===e.key&&!n&&s.length>0&&d(s[s.length-1])},onBlur:a,placeholder:0===s.length?"Type class name and press Enter...":"",style:{flex:1,minWidth:"140px",border:"none",background:"transparent",outline:"none",fontSize:"13px",fontFamily:"Monaco, Menlo, monospace",padding:"6px",color:"#1e1e1e"}})]}),(0,c.jsxs)("div",{style:{marginTop:"8px",fontSize:"11px",color:"#666",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[(0,c.jsx)("span",{style:{flex:1},children:"Press Enter to add • Backspace to remove last"}),s.length>0&&(0,c.jsx)("button",{onClick:()=>t(""),style:{background:"transparent",border:"none",color:"#d63638",cursor:"pointer",fontSize:"11px",padding:"4px 8px",textDecoration:"underline",whiteSpace:"nowrap"},children:"Clear all"})]})]})}function k({attributes:e,setAttributes:t}){const{loopSource:n,loopVariable:l,conditionalVisibility:i,conditionalExpression:r,setVariable:a,setExpression:d}=e;return(0,c.jsxs)(c.Fragment,{children:[h("loopControls")&&(0,c.jsxs)(s.PanelBody,{title:(0,o.__)("Loop Controls","universal-block"),initialOpen:!1,children:[(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("Enable Loop","universal-block"),checked:!!n,onChange:e=>{t(e?{loopSource:"posts"}:{loopSource:"",loopVariable:"item"})},help:(0,o.__)("Repeat this element for each item in a collection","universal-block")}),n&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.TextControl,{label:(0,o.__)("Loop Source","universal-block"),value:n,onChange:e=>t({loopSource:e}),placeholder:"posts",help:(0,o.__)("Collection to loop over (e.g., posts, user.posts, timber.get_posts(...))","universal-block")}),(0,c.jsx)(s.TextControl,{label:(0,o.__)("Item Variable","universal-block"),value:l,onChange:e=>t({loopVariable:e}),placeholder:"item",help:(0,o.__)("Variable name for each item in the loop","universal-block")}),(0,c.jsxs)(s.Notice,{status:"info",isDismissible:!1,children:[(0,c.jsx)("strong",{children:"Output:"})," ",`{% for ${l||"item"} in ${n||"..."} %}`]})]})]}),h("conditionalVisibility")&&(0,c.jsxs)(s.PanelBody,{title:(0,o.__)("Conditional Visibility","universal-block"),initialOpen:!1,children:[(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("Enable Conditional","universal-block"),checked:i,onChange:e=>{t(e?{conditionalVisibility:!0}:{conditionalVisibility:!1,conditionalExpression:""})},help:(0,o.__)("Show this element only when condition is true","universal-block")}),i&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.TextControl,{label:(0,o.__)("Condition","universal-block"),value:r,onChange:e=>t({conditionalExpression:e}),placeholder:"item.title",help:(0,o.__)("Twig expression to evaluate (e.g., item.title, user.ID > 0)","universal-block")}),(0,c.jsxs)(s.Notice,{status:"info",isDismissible:!1,children:[(0,c.jsx)("strong",{children:"Output:"})," ",`{% if ${r||"..."} %}`]})]})]}),h("setVariable")&&(0,c.jsxs)(s.PanelBody,{title:(0,o.__)("Set Variable","universal-block"),initialOpen:!1,children:[(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("Set Variable","universal-block"),checked:!!a,onChange:e=>{t(e?{setVariable:"my_var"}:{setVariable:"",setExpression:""})},help:(0,o.__)("Define a Twig variable before this element","universal-block")}),a&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.TextControl,{label:(0,o.__)("Variable Name","universal-block"),value:a,onChange:e=>t({setVariable:e}),placeholder:"my_var",help:(0,o.__)("Name of the variable to create","universal-block")}),(0,c.jsx)(s.TextControl,{label:(0,o.__)("Expression","universal-block"),value:d,onChange:e=>t({setExpression:e}),placeholder:"timber.get_posts({post_type: 'posts'})",help:(0,o.__)("Twig expression to assign to the variable","universal-block")}),(0,c.jsxs)(s.Notice,{status:"info",isDismissible:!1,children:[(0,c.jsx)("strong",{children:"Output:"})," ",`{% set ${a||"..."} = ${d||"..."} %}`]})]})]})]})}function m(){return(0,c.jsxs)("div",{className:"universal-block-preview-loading",style:{padding:"20px",background:"#f9f9f9",border:"2px dashed #ddd",borderRadius:"4px",textAlign:"center"},children:[(0,c.jsx)(s.Spinner,{style:{margin:"0 auto 10px"}}),(0,c.jsx)("p",{style:{margin:0,color:"#666",fontSize:"14px"},children:(0,o.__)("Loading dynamic preview...","universal-block")})]})}function f({error:e,onRetry:t}){return(0,c.jsx)("div",{className:"universal-block-preview-error",style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"4px"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,c.jsx)("span",{style:{fontSize:"20px",lineHeight:1,color:"#856404"},children:"⚠️"}),(0,c.jsxs)("div",{style:{flex:1},children:[(0,c.jsx)("p",{style:{margin:"0 0 10px",color:"#856404",fontWeight:"600"},children:(0,o.__)("Preview Error","universal-block")}),(0,c.jsx)("p",{style:{margin:"0 0 10px",color:"#856404",fontSize:"13px"},children:e}),(0,c.jsx)(s.Button,{variant:"secondary",size:"small",onClick:t,style:{background:"#fff",borderColor:"#856404",color:"#856404"},children:(0,o.__)("Retry Preview","universal-block")})]})]})})}function _({onExitPreview:e,onSelectBlock:t}){return(0,c.jsxs)("div",{className:"universal-block-preview-badge",style:{position:"absolute",top:"8px",right:"8px",display:"flex",alignItems:"center",gap:"8px",background:"#4CAF50",color:"white",padding:"4px 8px",borderRadius:"3px",fontSize:"11px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",zIndex:10,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:[(0,c.jsx)("span",{children:(0,o.__)("Preview Mode","universal-block")}),(0,c.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[(0,c.jsx)(s.Button,{icon:"admin-generic",label:(0,o.__)("Select Block","universal-block"),onClick:e=>{e.stopPropagation(),t()},style:{minWidth:"auto",height:"20px",padding:"2px",color:"white",background:"rgba(255, 255, 255, 0.2)",border:"none"},className:"universal-block-preview-select-btn"}),(0,c.jsx)(s.Button,{icon:"edit",label:(0,o.__)("Exit Preview","universal-block"),onClick:t=>{t.stopPropagation(),e()},style:{minWidth:"auto",height:"20px",padding:"2px",color:"white",background:"rgba(255, 255, 255, 0.2)",border:"none"},className:"universal-block-preview-edit-btn"})]})]})}function y({html:e,isLoading:t,error:n,onRetry:l,onExitPreview:i,showBadge:r=!0}){return t?(0,c.jsx)(m,{}):n?(0,c.jsx)(f,{error:n,onRetry:l}):e?(0,c.jsxs)("div",{className:"universal-block-preview-container",style:{position:"relative",padding:"16px",background:"transparent",border:"2px dashed rgba(76, 175, 80, 0.3)",borderRadius:"4px",minHeight:"50px"},children:[r&&(0,c.jsx)(_,{onExitPreview:i}),(0,c.jsx)("div",{className:"universal-block-preview-content",dangerouslySetInnerHTML:{__html:e}})]}):(0,c.jsx)("div",{className:"universal-block-preview-empty",style:{padding:"20px",background:"#f0f0f0",border:"2px dashed #ccc",borderRadius:"4px",textAlign:"center",color:"#666"},children:(0,c.jsx)("p",{style:{margin:0,fontSize:"14px"},children:(0,o.__)("Preview will appear here when data is loaded","universal-block")})})}const w=window.wp.apiFetch;var j=n.n(w);function C(){const e=window.ubBlockSettings?.allowedContentTypes||["blocks","text","html","empty"];return[{label:"Blocks (Container)",value:"blocks"},{label:"Text",value:"text"},{label:"HTML",value:"html"},{label:"Empty",value:"empty"}].filter(t=>e.includes(t.value))}new class{constructor(e=50,t=3e5){this.cache=new Map,this.maxSize=e,this.ttl=t}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>this.ttl?(this.cache.delete(e),null):t.value:null}set(e,t){if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,{value:t,timestamp:Date.now()})}clear(){this.cache.clear()}has(e){return this.cache.has(e)}};const T=(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",children:(0,c.jsx)("path",{d:"M12 3C7.58 3 4 4.79 4 7v10c0 2.21 3.59 4 8 4s8-1.79 8-4V7c0-2.21-3.58-4-8-4zm6 14c0 .55-2.69 2-6 2s-6-1.45-6-2v-2.23c1.61.78 3.72 1.23 6 1.23s4.39-.45 6-1.23V17zm0-4.55c-1.3.95-3.58 1.55-6 1.55s-4.7-.6-6-1.55V9.64c1.47.83 3.61 1.36 6 1.36s4.53-.53 6-1.36v2.81zM12 9C8.69 9 6 7.55 6 7s2.69-2 6-2 6 1.45 6 2-2.69 2-6 2z"})}),S={renderAppender:i.InnerBlocks.ButtonBlockAppender};(0,l.registerBlockType)("universal/element",{icon:(0,c.jsxs)("svg",{width:"18",height:"22",viewBox:"0 0 18 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,c.jsx)("path",{d:"M18 19.3527L16.8609 17.886H10.3108V16.3093H15.6414L14.5095 14.8427H10.3108V13.266H15.8677L14.8162 11.7993H10.3108V10.2227H13.6917L12.6402 8.756H10.3108V7.17933H13.5091L12.4795 5.71267H10.3108V4.136H11.3696L10.34 2.66933H10.3108V0L5.50588 6.72467L8.20771 6.732L2.75294 14.366H5.5643L0 22H10.3108V19.3527H18Z",fill:"url(#paint0_radial_4_2)"}),(0,c.jsx)("defs",{children:(0,c.jsxs)("radialGradient",{id:"paint0_radial_4_2",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(9 13) rotate(90) scale(9 7.36364)",children:[(0,c.jsx)("stop",{stopColor:"#54FFB9"}),(0,c.jsx)("stop",{offset:"1",stopColor:"#03D781"})]})})]}),edit:function({attributes:e,setAttributes:t,clientId:n}){const{tagName:p="div",contentType:b="blocks",content:m="",globalAttrs:f={},isSelfClosing:_=!1,dynamicPreview:w=!1}=e,[B,E]=(0,r.useState)(""),[L,P]=(0,r.useState)(!1),[M,H]=(0,r.useState)(null),R=(0,r.useMemo)(()=>{const e={};for(const t in f)"class"!==t&&(e[t]=f[t]);return e.id||(e.id=`block-${n}`),e},[f,n]),N=(0,i.useBlockProps)({className:e.className||"",...R,..."a"===p&&{onClick:e=>e.preventDefault()}}),A=(0,i.useInnerBlocksProps)(N,S),V=(0,r.useMemo)(()=>{const e={...N};return"a"===p&&(e.onClick=e=>e.preventDefault()),e},[N,p]),z=(0,r.useCallback)(e=>t({tagName:e}),[t]),I=(0,r.useCallback)(e=>t({contentType:e}),[t]),O=(0,r.useCallback)(()=>t({dynamicPreview:!w}),[w,t]),D=(0,r.useCallback)(async()=>{P(!0),H(null);try{const e=function(e){const{getBlock:t}=wp.data.select("core/block-editor"),n=t(e);if(!n)throw new Error("Block not found");return wp.blocks.serialize(n)}(n),t=function(){const e=window.universal?.preview||{};return window.ubPreviewData,{postId:e.post_id||0,postType:e.post_type||"page",currentUser:e.meta?.author||{},type:e.type||"singular",settings:e.settings||{},meta:e.meta||{},dynamic_block:!0}}(),l=await async function(e,t,n){try{const l=await j()({path:"/universal-block/v1/dynamic-preview",method:"POST",data:{blockContent:e,blockId:t,context:n}});if(!l.success)throw new Error(l.message||"Preview generation failed");return l}catch(e){if(e.message.includes("Twig"))throw new Error(`Twig Syntax Error: ${e.message}`);if(e.message.includes("fetch"))throw new Error("Network error: Unable to fetch preview");throw e}}(e,n,t);E(l.content||"")}catch(e){console.error("Preview error:",e),H(e.message||"Failed to load preview")}finally{P(!1)}},[n]),F=(0,r.useMemo)(()=>(0,a.debounce)(D,500),[D]);(0,r.useEffect)(()=>(w?F():(E(""),H(null)),()=>{F.cancel()}),[w,e,F]);const U=(0,r.useCallback)(()=>{"function"==typeof window.openUniversalBlockHtmlEditor?window.openUniversalBlockHtmlEditor():console.error("HTML Editor not available. Make sure editor tweaks are loaded.")},[]),W=(0,r.useCallback)(()=>{"function"==typeof window.openUniversalBlockAttributesEditor?window.openUniversalBlockAttributesEditor():console.error("Attributes Editor not available. Make sure editor tweaks are loaded.")},[]),$=p;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(i.BlockControls,{children:[h("tagNameToolbar")&&(0,c.jsx)(s.ToolbarGroup,{children:(0,c.jsx)(x,{tagName:p,onChange:z})}),h("dynamicPreviewButton")&&(0,c.jsx)(s.ToolbarGroup,{children:(0,c.jsx)(s.Button,{icon:T,label:(0,o.__)("Toggle Dynamic Preview","universal-block"),isPressed:w,onClick:O})})]}),(0,c.jsxs)(i.InspectorControls,{children:[h("plainClassesManager")&&(0,c.jsx)("div",{style:{padding:"16px",borderBottom:"1px solid #e0e0e0"},children:(0,c.jsx)(v,{className:e.className||"",onChange:e=>t({className:e})})}),h("dynamicPreviewToggle")&&(0,c.jsx)("div",{style:{padding:"16px",borderBottom:"1px solid "+(w?"rgba(59, 130, 246, 0.2)":"#e0e0e0"),background:"transparent"},children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,c.jsx)("div",{style:{flex:1},children:(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("Dynamic Preview","universal-block"),checked:w,onChange:O,help:w?(0,o.__)("Preview mode active - showing live data from Timber/Twig context","universal-block"):(0,o.__)("Enable to preview dynamic content with real data","universal-block")})}),w&&(0,c.jsx)(s.Button,{icon:"edit",label:(0,o.__)("Edit Block","universal-block"),onClick:()=>{t({dynamicPreview:!1})},style:{marginTop:"-8px",color:"#3b82f6"}})]})}),h("elementSettings")&&(0,c.jsxs)(s.PanelBody,{title:(0,o.__)("Element Settings","universal-block"),children:[(0,c.jsx)(s.TextControl,{label:(0,o.__)("HTML Tag","universal-block"),value:p,onChange:e=>t({tagName:e}),help:(0,o.__)("Enter any HTML tag name (e.g., div, section, custom-element)","universal-block")}),g("elementSettings","contentType")&&(0,c.jsx)(s.SelectControl,{label:(0,o.__)("Content Type","universal-block"),value:b,options:C(),onChange:I}),"text"===b&&g("elementSettings","textContent")&&(0,c.jsx)(s.TextareaControl,{label:(0,o.__)("Text Content","universal-block"),value:m,onChange:e=>t({content:e}),rows:4,help:(0,o.__)("Enter plain text content for this element","universal-block"),style:{marginTop:"12px"}}),g("elementSettings","selfClosing")&&(0,c.jsx)(s.ToggleControl,{label:(0,o.__)("Self Closing","universal-block"),checked:_,onChange:e=>t({isSelfClosing:e}),help:(0,o.__)("Render as self-closing tag (e.g., <img />)","universal-block")}),g("elementSettings","editAttributes")&&(0,c.jsxs)(s.Button,{variant:"secondary",onClick:W,style:{marginTop:"8px",width:"100%"},children:[(0,c.jsx)("i",{className:"ri-braces-line",style:{marginRight:"6px"}}),(0,o.__)("Edit Attributes","universal-block")]}),"blocks"===b&&g("elementSettings","toHtml")&&(0,c.jsxs)(s.Button,{variant:"secondary",onClick:()=>{const{getBlock:e}=wp.data.select("core/block-editor"),l=e(n);if(!l||!l.innerBlocks||0===l.innerBlocks.length)return void alert("No blocks to convert");if(void 0===window.universal||"function"!=typeof window.universal.blocks2html)return console.error("Blocks to HTML serializer not loaded"),void alert("Serializer not available. Please refresh the page.");const o=window.universal.blocks2html(l.innerBlocks);if(!o)return void alert("Could not convert blocks to HTML");t({contentType:"html",content:o});const{replaceInnerBlocks:i}=wp.data.dispatch("core/block-editor");i(n,[])},style:{marginTop:"8px",width:"100%"},children:[(0,c.jsx)("i",{className:"ri-code-line",style:{marginRight:"6px"}}),(0,o.__)("To HTML","universal-block")]}),"html"===b&&(0,c.jsxs)(s.ButtonGroup,{style:{marginTop:"8px",display:"flex",gap:"8px"},children:[g("elementSettings","editHtml")&&(0,c.jsxs)(s.Button,{variant:"secondary",onClick:U,style:{flex:1},children:[(0,c.jsx)("i",{className:"ri-code-line",style:{marginRight:"6px"}}),(0,o.__)("Edit HTML","universal-block")]}),m&&g("elementSettings","toBlocks")&&(0,c.jsxs)(s.Button,{variant:"secondary",onClick:()=>{if(!m)return void alert("No HTML content to convert");if(void 0===window.universal||"function"!=typeof window.universal.html2blocks)return console.error("HTML to blocks parser not loaded"),void alert("HTML parser not available. Please refresh the page.");const e=window.universal.html2blocks(m);if(!e||0===e.length)return void alert("Could not convert HTML to blocks");const o=e=>{const t=e.innerBlocks&&e.innerBlocks.length>0?e.innerBlocks.map(o):[];return(0,l.createBlock)(e.name,e.attributes,t)},i=e.map(o);t({contentType:"blocks",content:""});const{replaceInnerBlocks:r}=wp.data.dispatch("core/block-editor");r(n,i)},style:{flex:1},children:[(0,c.jsx)("i",{className:"ri-stack-line",style:{marginRight:"6px"}}),(0,o.__)("To Blocks","universal-block")]})]})]}),"img"===p&&h("imageSettings")&&(0,c.jsx)(d,{globalAttrs:f,setAttributes:t}),"a"===p&&h("linkSettings")&&(0,c.jsx)(u,{globalAttrs:f,setAttributes:t}),(0,c.jsx)(k,{attributes:e,setAttributes:t})]}),w?(0,c.jsx)(y,{html:B,isLoading:L,error:M,onRetry:D,onExitPreview:()=>t({dynamicPreview:!1}),onSelectBlock:()=>{const{selectBlock:e}=wp.data.dispatch("core/block-editor");e(n)},showBadge:!0}):(0,c.jsxs)(c.Fragment,{children:["blocks"===b&&(0,c.jsx)($,{...A,children:A.children}),"text"===b&&(0,c.jsx)(i.RichText,{tagName:p,value:m,onChange:e=>t({content:e}),placeholder:(0,o.__)("Enter text...","universal-block"),...V}),"html"===b&&(0,c.jsx)($,{...V,dangerouslySetInnerHTML:{__html:m||'<p style="color: #999; padding: 20px; text-align: center;">No HTML content. Use the sidebar to open the HTML editor.</p>'}}),"empty"===b&&(0,c.jsx)($,{...V})]})]})},save:function({attributes:e}){const{contentType:t="blocks"}=e;return"blocks"===t?(0,c.jsx)(i.InnerBlocks.Content,{}):null}})}},n={};function l(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e](i,i.exports,l),i.exports}l.m=t,e=[],l.O=(t,n,o,i)=>{if(!n){var r=1/0;for(d=0;d<e.length;d++){for(var[n,o,i]=e[d],s=!0,a=0;a<n.length;a++)(!1&i||r>=i)&&Object.keys(l.O).every(e=>l.O[e](n[a]))?n.splice(a--,1):(s=!1,i<r&&(r=i));if(s){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};l.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,s,a]=n,c=0;if(r.some(t=>0!==e[t])){for(o in s)l.o(s,o)&&(l.m[o]=s[o]);if(a)var d=a(l)}for(t&&t(n);c<r.length;c++)i=r[c],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(d)},n=globalThis.webpackChunkuniversal_block=globalThis.webpackChunkuniversal_block||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=l.O(void 0,[350],()=>l(575));o=l.O(o)})();